#https://uk.investing.com/rates-bonds/india-15-year-bond-yield
#PRELIMINARIES
rm(list = ls())
library(zoo)
library(xts)
library(tidyverse)
library(urca)
library(vars)
library(tsDyn)
options(scipen = 999)
setwd("C:/Users/Nish/OneDrive - University of Bristol/TB2/Applied Financial Econometrics/Coursework")
bse<-read.csv("S&P BSE SENSEX.csv")
sr<-read.csv("1yr Historical Bond Data India.csv")
lr<-read.csv("15yr Historical Bond Data India.csv")
#DATA PROCESSING/FORMATTING
bse$Close<-as.numeric(as.character(bse$Close))
bse$Date<-as.Date(bse$Date,"%d/%m/%Y")
sr$ï..Date<-as.Date(sr$ï..Date,"%B %d, %Y")
lr$ï..Date<-as.Date(lr$ï..Date,"%B %d, %Y")
#PROCESSING BONDS
data <- merge(sr, lr, join = "right")
data <- data.frame(sr=data$X1yr,
lr=data$X15yr,
Date = data$ï..Date,
year = as.numeric(format(data$ï..Date, format = "%Y")),
month = as.numeric(format(data$ï..Date, format = "%m")),
day = as.numeric(format(data$ï..Date, format = "%d")))
data$ym <- as.yearmon(paste(data$year, data$month), "%Y %m")
sr_xts <- xts(data$sr, data$ym)
lr_xts <-xts(data$lr, data$ym)
sr_xts<-apply.monthly(sr_xts,mean)
lr_xts<-apply.monthly(lr_xts,mean)
bonds_xts <- merge(sr_xts, lr_xts, join = "right")
#PROCESSING INDEX VALUES
data2 <- data.frame(bse=bse$Close,
Date = bse$Date,
year = as.numeric(format(bse$Date, format = "%Y")),
month = as.numeric(format(bse$Date, format = "%m")),
day = as.numeric(format(bse$Date, format = "%d")))
data2$ym <- as.yearmon(paste(data2$year, data2$month), "%Y %m")
data2_xts <- xts(data2$bse, data2$ym)
#TAKING A DAILY AVERAGE FOR EACH MONTH TO CONVERT INTO MONTHLY DATA FOR 10 YEARS
bse_xts<-apply.monthly(data2_xts,mean)
bseND <- merge.xts(bse_xts, bonds_xts,join = "right", fill = NA)
colnames(bseND)[1:3] <-c("bse","sr","lr")
rm(bse_xts,bse,data2,data2_xts,lr_xts,sr_xts,sr,lr,data,bonds_xts)
#THIS FUNCTION TURNS THE SHORT RUN AND LONG RUN YIELDS INTO A SPREAD WHICH CHARACTERISES THE SLOPE OF THE YIELD CURVE.
bseND$term<-bseND$lr-bseND$sr
#SOME BASIC PLOTS
plot(index(bseND),bseND$bse,type="l")
plot(index(bseND),bseND$sr,type="l")
plot(index(bseND),bseND$lr,type="l")
plot(index(bseND),bseND$term,type="l")
#STEP 1
#RUNNING UNIT ROOT TESTS ON THE TREND
adfbse<-ur.df(bseND$bse,type="trend",selectlags="AIC")
adfsr<-ur.df(bseND$sr,type="trend",selectlags="AIC")
adflr<-ur.df(bseND$lr,type="trend",selectlags="AIC")
adfterm<-ur.df(bseND$term,type="trend",selectlags="AIC")
#ADF for bse
summary(adfbse)
#ADF for sr
summary(adfsr)
#ADF for lr
summary(adflr)
#ADF for term
summary(adfterm)
#Results show that all are non-stationary at the 5% level except term structure, which is stationary at the 5% level.
#STEP 2
#RUNNING A REGRESSION ON THE TREND
Dbse <- na.omit(diff(bseND$bse, differences=1))
Dsr <- na.omit(diff(bseND$sr, differences=1))
Dlr <- na.omit(diff(bseND$lr, differences=1))
Dterm <- na.omit(diff(bseND$term, differences=1))
Lbse <- na.omit(stats::lag(bseND$bse, k=1))
Lsr <- na.omit(stats::lag(bseND$sr, k=1))
Llr <- na.omit(stats::lag(bseND$lr, k=1))
Lterm <- na.omit(stats::lag(bseND$term, k=1))
LDbse <- na.omit(stats::lag(Dbse, k=1))
LDsr <- na.omit(stats::lag(Dsr, k=1))
LDlr <- na.omit(stats::lag(Dlr, k=1))
LDterm <- na.omit(stats::lag(Dterm, k=1))
ttdata<-cbind(Dbse,Dsr,Dlr,Dterm,Lbse,Lsr,Llr,Lterm,LDbse,LDsr,LDlr,LDterm)
ttdata<-na.omit(ttdata)
adfbse<-lm(ttdata$bse ~ c(1:length(ttdata$bse))+ttdata$bse.2)
adfsr<-lm(ttdata$sr ~ c(1:length(ttdata$sr))+ttdata$sr.2)
adflr<-lm(ttdata$lr ~ c(1:length(ttdata$lr))+ttdata$lr.2)
adfterm<-lm(ttdata$term ~ c(1:length(ttdata$term))+ttdata$term.2)
#ADF for bse
summary(adfbse)
#ADF for sr
summary(adfsr)
#ADF for lr
summary(adflr)
#ADF for term
summary(adfterm)
#The results show that the time trend cannot be rejected at the 1% level for the variables - this is necessary as financial time series data
#has been empirically proven to be DS and therefore needs strong evidence otherwise
#STEP 3
adfbse <- ur.df(bseND$bse, type="drift", selectlags="AIC")
adfsr <- ur.df(bseND$sr, type="drift", selectlags="AIC")
adflr <- ur.df(bseND$lr, type="drift", selectlags="AIC")
adfterm <- ur.df(bseND$term, type="drift", selectlags="AIC")
#ADF for bse
summary(adfbse)
#ADF for sr
summary(adfsr)
#ADF for lr
summary(adflr)
#ADF for term
summary(adfterm)
#Non-stationary for all variables at 5% except for term variable.
#STEP 4
adfbse <- ur.df(bseND$bse, type="none")
adfsr <- ur.df(bseND$sr, type="none")
adflr <- ur.df(bseND$lr, type="none")
adfterm <- ur.df(bseND$term, type="none")
#ADF for bse
summary(adfbse)
#ADF for sr
summary(adfsr)
#ADF for lr
summary(adflr)
#ADF for term
summary(adfterm)
#It is not possible to reject any of the variables at the 1% level in this situation, therefore it is concluded that, both relevant variables
#bse and term are difference stationary. Individually, the short run and long run yields are difference stationary, which would support
#the spread to being difference stationary as well, even though it showed less evidence of such compared to the two individually.
adfbse <- ur.df(ttdata$bse, type="drift", selectlags="AIC")
adfterm <- ur.df(ttdata$term, type="drift", selectlags="AIC")
#ADF for First difference bse
summary(adfbse)
#ADF for First different term
summary(adfterm)
#Based on the conclusions seen in this test - we can reject the null for a unit root and conclude difference stationarity with an
#integrated order of 1.
#CALCULATING THE RETURNS FOR THE VARIABLES
#Take logs for percentage form
bseND$rbse <- diff(log(bseND$bse))
bseND$rsr <- diff(bseND$sr)
bseND$rlr <- diff(bseND$lr)
bseND$rterm <- bseND$rlr-bseND$rsr
rbseND <- na.omit(cbind(bseND$rbse,bseND$rsr,bseND$rlr,bseND$rterm))
plot(bseND$rbse, col="red")
lines(bseND$rterm, col="blue")
vardata <- cbind(bseND$rbse, bseND$rsr, bseND$rlr, bseND$rterm)
vardata <- na.omit(vardata)
rm(adfbse,adflr,adfsr,adfterm,Dbse,Dlr,Dsr,Dterm,Lbse,LDbse,LDlr,LDsr,LDterm,Llr,Lsr,Lterm,ttdata)
KeyVars <- cbind(bseND$bse,bseND$term)
KeyVars2 <- cbind(log(bseND$bse),log(bseND$lr)-log(bseND$sr))
colnames(KeyVars2)[2] <- "term"
#So far we have concluded that the original data are I(1), and then I(0) as a result of taking their differences. This makes the returns
#variables suitable for VAR modeling, however before this, it would be worthwhile to check if there exists some cointegrating relationship
#between the the variables, before settling on a model. Do the series' share a common stochastic drift?
#Lag selection
VARselect(KeyVars2, lag.max=24, type = "both")
#Using the level variables the number of lags that minimizes the AIC using the VARselect method is 2, using a maximum lag of 24 months
#and including both a trend and drift which are evident in the series' plots.
#Engle Granger
#Before we consider any further cointegration analysis - we should consider doing a 2-step EG procedure, this will identify any possible
#cointegrating relation
#Engle Granger Step 1
Step1 <- lm(KeyVars2$bse ~ KeyVars2$term + c(1:length(KeyVars2$bse)))
summary(Step1)
#Are the residuals stationary or not?
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
#using T^{0.25}=132^{0.25}=3 lags approx
ADFres <- ur.df(predres, type="none", selectlags=3)
summary(ADFres)
#Reject the null at all levels - conclude that the residuals do not contain a unit root and are stationary, and also implies there may
#be some cointegrating relationship between the BSE SENSEX and the slope of the yield curve.
#Engle Granger Step 2
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rterm, k=2) + stats::lag(rbseND$rbse, k=2)+ na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#Drop the second lag of term
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rbse, k=2)+ na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#Drop the second lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
+ na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#Drop the first lag of rterm
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rbse)+
+ na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#Drop the first lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#All variables are now significant - and the ecm term has interpretation
#The Johansen test can take 2 forms, one being trace test and maximal eigenvalue.
#Trace test
JtestTrace1 <- ca.jo(KeyVars2, type = "trace", ecdet = "none", K = 2, spec = "transitory")
summary (JtestTrace1)
# r<=1 Cannot reject at any level
# r=0 Reject at the 5% level
#1 cointegrating relation
JtestTrace2 <- ca.jo(KeyVars2, type = "trace", ecdet = "const", K = 2, spec = "transitory")
summary (JtestTrace2)
# r<=1 Cannot reject at any level
# r=0 Reject at the 5% level
#1 cointegrating relation
JtestTrace3 <- ca.jo(KeyVars2, type = "trace", ecdet = "trend", K = 2, spec = "transitory")
summary (JtestTrace3)
# r<=1 Reject at 5%
# r=0 Reject at all levels
#This may favour a situation of no cointegrating relationship.
#Maximal eigenvalue
Jtesteigen <- ca.jo(KeyVars2, type = "eigen", ecdet = "none", K = 2, spec = "transitory")
summary (Jtesteigen)
# r<=1 Cannot reject at any level
# r=0 Reject at the 5% level
#1 cointegrating relation
#Estimating the VECM model
#vecm1 <- cajorls(JtestTrace1, r=1)
#vecm1
#vecm2 <- cajorls(JtestTrace2, r=1)
#vecm2
#vecm3 <- cajorls(JtestTrace3, r=1)
#vecm3
#vecmeigen <- cajorls(Jtesteigen, r=1)
#vecmeigen
vecm1 <- VECM(KeyVars2,lag=2,r=1,include=c("none"),estim=c("ML"))
summary(vecm1)
coefs_1 <- summary(vecm1)$coefMat
coefs_1
vecm2 <- VECM(KeyVars2,lag=2,r=1,include=c("const"),estim=c("ML"))
summary(vecm2)
coefs_2 <- summary(vecm2)$coefMat
coefs_2
vecm3 <- VECM(KeyVars2,lag=2,r=1,include=c("trend"),estim=c("ML"))
summary(vecm3)
coefs_3 <- summary(vecm3)$coefMat
coefs_3
EG2 <- lm(diff(KeyVars2$bse) ~ diff(KeyVars2$term) + stats::lag(diff(KeyVars2$bse)) +
stats::lag(diff(KeyVars2$bse),k=2) +stats::lag(predres))
summary(EG2)
View(rbseND)
View(rbseND)
View(bseND)
View(bseND)
View(rbseND)
View(rbseND)
View(bseND)
View(rbseND)
View(vardata)
View(bseND)
bseND$rbse <- diff(log(bseND$bse))
bseND$rsr <- diff(bseND$sr)
bseND$rlr <- diff(bseND$lr)
bseND$rterm <- bseND$rlr-bseND$rsr
rbseND <- na.omit(cbind(bseND$rbse,bseND$rsr,bseND$rlr,bseND$rterm))
vardata <- cbind(bseND$rbse, bseND$rsr, bseND$rlr, bseND$rterm)
vardata <- na.omit(vardata)
plot(bseND$rbse, col="red")
lines(bseND$rterm, col="blue")
rm(adfbse,adflr,adfsr,adfterm,Dbse,Dlr,Dsr,Dterm,Lbse,LDbse,LDlr,LDsr,LDterm,Llr,Lsr,Lterm,ttdata)
bseND$rbse <- diff(log(bseND$bse))
bseND$rsr <- diff(log(bseND$sr))
bseND$rlr <- diff(log(bseND$lr))
bseND$rterm <- bseND$rlr-bseND$rsr
rbseND <- na.omit(cbind(bseND$rbse,bseND$rsr,bseND$rlr,bseND$rterm))
vardata <- cbind(bseND$rbse, bseND$rsr, bseND$rlr, bseND$rterm)
vardata <- na.omit(vardata)
plot(bseND$rbse, col="red")
lines(bseND$rterm, col="blue")
View(bseND)
rm(adfbse,adflr,adfsr,adfterm,Dbse,Dlr,Dsr,Dterm,Lbse,LDbse,LDlr,LDsr,LDterm,Llr,Lsr,Lterm,ttdata)
warnings()
eg1var <- na.omit(cbind(log(bseND$bse),bseND$rterm))
VARselect(eg1var, lag.max=24, type = "both")
View(eg1var)
eg1var <- na.omit(cbind(log(bseND$bse),bseND$rterm))
#Engle Granger Step 1
Step1 <- lm(eg1var$bse ~ eg1var$term + c(1:length(eg1var$bse)))
summary(Step1)
#Are the residuals stationary or not?
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
#using T^{0.25}=132^{0.25}=3 lags approx
ADFres <- ur.df(predres, type="none", selectlags=3)
summary(ADFres)
#Reject the null at all levels - conclude that the residuals do not contain a unit root and are stationary, and also implies there may
#be some cointegrating relationship between the BSE SENSEX and the slope of the yield curve.
View(eg1var)
Step1 <- lm(eg1var$bse ~ eg1var$term + c(1:length(eg1var$bse)))
summary(Step1)
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
ADFres <- ur.df(predres, type="none", selectlags=3)
summary(ADFres)
eg1var <- na.omit(cbind(log(bseND$bse),bseND$rterm))
#Engle Granger Step 1
Step1 <- lm(eg1var$bse ~ eg1var$rterm + c(1:length(eg1var$bse)))
summary(Step1)
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
ADFres <- ur.df(predres, type="none", selectlags=3)
summary(ADFres)
View(eg1var)
#Engle Granger Step 2
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rterm, k=2) + stats::lag(rbseND$rbse, k=2)+ na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#Drop the second lag of term
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rbse, k=2)+ na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#Drop the second lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
+ na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#Drop the first lag of rterm
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rbse)+
+ na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
#Drop the first lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + na.omit(stats::lag(predres)))
summary (Step2)
AIC(Step2)
View(predres)
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rterm, k=2) + stats::lag(rbseND$rbse, k=2)+ (stats::lag(predres)))
summary (Step2)
#Engle Granger Step 2
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rterm, k=2) + stats::lag(rbseND$rbse, k=2)+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the second lag of term
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rbse, k=2)+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the second lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the first lag of rterm
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rbse)+
+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the first lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(predres))
summary (Step2)
AIC(Step2)
#All variables are now significant - and the ecm term has interpretation
eg1var <- na.omit(cbind(log(bseND$bse),bseND$rterm))
#Engle Granger Step 1
Step1 <- lm(eg1var$bse ~ eg1var$rterm + c(1:length(eg1var$bse)))
summary(Step1)
#Are the residuals stationary or not?
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
#using T^{0.25}=132^{0.25}=3 lags approx
ADFres <- ur.df(predres, type="none", selectlags=3)
summary(ADFres)
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
#using T^{0.25}=132^{0.25}=3 lags approx
ADFres <- ur.df(predres, type="none", selectlags="3")
summary(ADFres)
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags=AIC)
summary(ADFres)
#using T^{0.25}=132^{0.25}=3 lags approx
ADFres <- ur.df(predres, type="none", selectlags="3")
summary(ADFres)
Step1 <- lm(eg1var$bse ~ eg1var$rterm + c(1:length(eg1var$bse)))
summary(Step1)
#Are the residuals stationary or not?
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", lags="AIC")
summary(ADFres)
#using T^{0.25}=132^{0.25}=3 lags approx
ADFres <- ur.df(predres, type="none", selectlags="3")
summary(ADFres)
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", lags="AIC")
summary(ADFres)
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
ADFres <- ur.df(predres, type="none", selectlags="3")
summary(ADFres)
ADFres <- ur.df(predres, type="none", lags="3")
summary(ADFres)
ADFres <- ur.df(predres, type="none", lags="3")
summary(ADFres)
ADFres <- ur.df(predres, type="none", lags=3)
summary(ADFres)
ADFres <- ur.df(predres, type="none", lags=3)
summary(ADFres)
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
View(rbseND)
bseND$rbse <- diff(log(bseND$bse))
bseND$rsr <- log(bseND$sr)
bseND$rlr <- log(bseND$lr)
bseND$rterm <- bseND$rlr-bseND$rsr
rbseND <- na.omit(cbind(bseND$rbse,bseND$rsr,bseND$rlr,bseND$rterm))
vardata <- cbind(bseND$rbse, bseND$rsr, bseND$rlr, bseND$rterm)
vardata <- na.omit(vardata)
plot(bseND$rbse, col="red")
lines(bseND$rterm, col="blue")
eg1var <- na.omit(cbind(log(bseND$bse),bseND$rterm))
VARselect(eg1var, lag.max=24, type = "both")
eg1var <- na.omit(cbind(log(bseND$bse),bseND$rterm))
#Engle Granger Step 1
Step1 <- lm(eg1var$bse ~ eg1var$rterm + c(1:length(eg1var$bse)))
summary(Step1)
#Are the residuals stationary or not?
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
#using T^{0.25}=132^{0.25}=3 lags approx
ADFres <- ur.df(predres, type="none", lags=3)
summary(ADFres)
#Reject the null at all levels - conclude that the residuals do not contain a unit root and are stationary, and also implies there may
#be some cointegrating r
plot(bseND$rterm)
plot(bseND$rterm)
plot(bseND$rbse)
bseND$rterm <- diff(bseND$rlr-bseND$rsr)
plot(bseND$rterm)
plot(bseND$rbse)
plot(bseND$rbse, col="red")
lines(bseND$rterm, col="blue")
bseND$rbse <- diff(log(bseND$bse))
bseND$rsr <- log(bseND$sr)
bseND$rlr <- log(bseND$lr)
bseND$rterm <- diff(bseND$rlr-bseND$rsr)
rbseND <- na.omit(cbind(bseND$rbse,bseND$rsr,bseND$rlr,bseND$rterm))
vardata <- cbind(bseND$rbse, bseND$rsr, bseND$rlr, bseND$rterm)
vardata <- na.omit(vardata)
eg1var <- na.omit(cbind(log(bseND$bse),bseND$rterm))
#Engle Granger Step 1
Step1 <- lm(eg1var$bse ~ eg1var$rterm + c(1:length(eg1var$bse)))
summary(Step1)
#Are the residuals stationary or not?
predres <- Step1$residuals
ADFres <- ur.df(predres, type="none", selectlags="AIC")
summary(ADFres)
#using T^{0.25}=132^{0.25}=3 lags approx
ADFres <- ur.df(predres, type="none", lags=3)
summary(ADFres)
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rterm, k=2) + stats::lag(rbseND$rbse, k=2)+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the second lag of term
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rbse, k=2)+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the second lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the first lag of rterm
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rbse)+
+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the first lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(predres))
summary (Step2)
AIC(Step2)
#All variables are now significant - and the ecm term has interpretation
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rterm, k=2) + stats::lag(rbseND$rbse, k=2)+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the second lag of term
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
stats::lag(rbseND$rbse, k=2)+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the second lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rterm) + stats::lag(rbseND$rbse)+
+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the first lag of rterm
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(rbseND$rbse)+
+ stats::lag(predres))
summary (Step2)
AIC(Step2)
#Drop the first lag of bse
Step2 <- lm(rbseND$rbse ~ rbseND$rterm + stats::lag(predres))
summary (Step2)
AIC(Step2)
#All variables are now significant - and the ecm term has interpretation
